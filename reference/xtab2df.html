<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extract survey data and descriptions from crosstabs into a tidy data frame — xtab2df • cwi</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract survey data and descriptions from crosstabs into a tidy data frame — xtab2df"><meta name="description" content=" Deprecation notice: Crosstab-related
functions have been moved from cwi to the dcws package. The versions here will be removed soon.
Like read_xtab &amp;amp; read_weights, this is a bespoke function
to make it easier to extract data from the DataHaven Community Wellbeing
Survey. Applications to other crosstabs are probably limited unless their
formatting is largely the same. After reading a crosstab excel file, xtab2df
extracts the question codes (e.g. Q4A), question text, categories, and
demographic groups, and joins those descriptions with survey responses and
values, making it ready for analysis. Under the hood there are 2 versions of this
function: one for crosstabs generated from SPSS (pre-2024 DCWS), and one for
crosstabs generated at DataHaven starting in 2024. Those in-house crosstabs
don't have categories included in headings in excel, but this function will
add them."><meta property="og:description" content=" Deprecation notice: Crosstab-related
functions have been moved from cwi to the dcws package. The versions here will be removed soon.
Like read_xtab &amp;amp; read_weights, this is a bespoke function
to make it easier to extract data from the DataHaven Community Wellbeing
Survey. Applications to other crosstabs are probably limited unless their
formatting is largely the same. After reading a crosstab excel file, xtab2df
extracts the question codes (e.g. Q4A), question text, categories, and
demographic groups, and joins those descriptions with survey responses and
values, making it ready for analysis. Under the hood there are 2 versions of this
function: one for crosstabs generated from SPSS (pre-2024 DCWS), and one for
crosstabs generated at DataHaven starting in 2024. Those in-house crosstabs
don't have categories included in headings in excel, but this function will
add them."><meta property="og:image" content="https://CT-Data-Haven.github.io/cwi/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cwi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.13.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/cwi.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/acs-updates.html">ACS updates</a></li>
    <li><a class="dropdown-item" href="../articles/regions.html">Regions</a></li>
    <li><a class="dropdown-item" href="../articles/shapefiles.html">Shapefiles</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CT-Data-Haven/cwi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extract survey data and descriptions from crosstabs into a tidy data frame</h1>
      <small class="dont-index">Source: <a href="https://github.com/CT-Data-Haven/cwi/blob/main/R/xtab2df.R" class="external-link"><code>R/xtab2df.R</code></a></small>
      <div class="d-none name"><code>xtab2df.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> <strong>Deprecation notice:</strong> Crosstab-related
functions have been moved from cwi to the dcws package. The versions here will be removed soon.
Like <code>read_xtab</code> &amp; <code>read_weights</code>, this is a bespoke function
to make it easier to extract data from the DataHaven Community Wellbeing
Survey. Applications to other crosstabs are probably limited unless their
formatting is largely the same. After reading a crosstab excel file, <code>xtab2df</code>
extracts the question codes (e.g. Q4A), question text, categories, and
demographic groups, and joins those descriptions with survey responses and
values, making it ready for analysis. Under the hood there are 2 versions of this
function: one for crosstabs generated from SPSS (pre-2024 DCWS), and one for
crosstabs generated at DataHaven starting in 2024. Those in-house crosstabs
don't have categories included in headings in excel, but this function will
add them.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">xtab2df</span><span class="op">(</span><span class="va">data</span>, <span class="va">year</span>, col <span class="op">=</span> <span class="va">x1</span>, code_pattern <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame as returned from <code>read_xtab</code>.</p></dd>


<dt id="arg-year">year<a class="anchor" aria-label="anchor" href="#arg-year"></a></dt>
<dd><p>Numeric: year of the survey (or end year, in the case of pooled data).
This tells the functions how to read the files, since formatting has changed
across years of the survey. Because the ability to read a file depends so much
on the year for which it was produced, this argument no longer has a default;
instead it must be supplied explicitly.</p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>The bare column name of where to find question codes and text.
Default: x1, based on names assigned by <code>read_xtab</code></p></dd>


<dt id="arg-code-pattern">code_pattern<a class="anchor" aria-label="anchor" href="#arg-code-pattern"></a></dt>
<dd><p>String: regex pattern denoting how to find cells that
contain only a question code, such as "Q10", "Q4B", or "ASTHMA", or to
split codes and question text within the same cell. This is
pretty finicky, so you probably don't want to change it.
If <code>NULL</code> (the default), the function will fill in <code>"^[A-Z\\d_]{2,20}$"</code> for
years before 2024, or <code>"^[A-Z\\d_]+(?=\\. )"</code> for 2024 onward.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with the following columns:</p><ul><li><p>code (if questions have codes in crosstabs)</p></li>
<li><p>q_number (if questions don't have codes in crosstabs, assigned in order they occur)</p></li>
<li><p>question</p></li>
<li><p>category (e.g. age, gender)</p></li>
<li><p>group (e.g. 18–34, male)</p></li>
<li><p>response</p></li>
<li><p>value</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>dcws::read_xtabs()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># this function is being deprecated</span></span></span>
<span class="r-in"><span><span class="co"># replace with the equivalent in the dcws package</span></span></span>
<span class="r-in"><span><span class="va">xt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/test_xtab2018.xlsx"</span>, package <span class="op">=</span> <span class="st">"dcws"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xtab</span> <span class="op">&lt;-</span> <span class="fu">dcws</span><span class="fu">::</span><span class="fu">read_xtabs</span><span class="op">(</span><span class="va">xt</span>, year <span class="op">=</span> <span class="fl">2018</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">dcws</span><span class="fu">::</span><span class="fu">xtab2df</span><span class="op">(</span><span class="va">xtab</span>, year <span class="op">=</span> <span class="fl">2018</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Camille Seaberry.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

